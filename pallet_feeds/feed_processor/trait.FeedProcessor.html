<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Feed Processor"><meta name="keywords" content="rust, rustlang, rust-lang, FeedProcessor"><title>FeedProcessor in pallet_feeds::feed_processor - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../pallet_feeds/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../pallet_feeds/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">FeedProcessor</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><ul><li><a href="#tymethod.object_mappings">object_mappings</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#provided-methods">Provided Methods</a></h3><ul><li><a href="#method.delete">delete</a></li><li><a href="#method.init">init</a></li><li><a href="#method.put">put</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#foreign-impls">Implementations on Foreign Types</a></h3><ul><li><a href="#impl-FeedProcessor%3CFeedId%3E-for-()">()</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div></section><h2 class="location"><a href="index.html">In pallet_feeds::feed_processor</a></h2><div id="sidebar-vars" data-name="FeedProcessor" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../pallet_feeds/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Trait <a href="../index.html">pallet_feeds</a>::<wbr><a href="index.html">feed_processor</a>::<wbr><a class="trait" href="#">FeedProcessor</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/pallet_feeds/feed_processor.rs.html#119-139">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust trait"><code>pub trait FeedProcessor&lt;FeedId&gt; {
    fn <a href="#tymethod.object_mappings" class="fnname">object_mappings</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_feed_id: FeedId, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">]</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="enum" href="enum.FeedObjectMapping.html" title="enum pallet_feeds::feed_processor::FeedObjectMapping">FeedObjectMapping</a>&gt;<span class="notable-traits"><span class="notable-traits-tooltip">ⓘ<span class="notable-traits-tooltiptext"><span class="docblock"><span class="notable">Notable traits for <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, A&gt;</span><code class="content"><span class="where fmt-newline">impl&lt;A&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Write.html" title="trait std::io::Write">Write</a> for <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, A&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;A: <a class="trait" href="https://doc.rust-lang.org/nightly/core/alloc/trait.Allocator.html" title="trait core::alloc::Allocator">Allocator</a>,&nbsp;</span></span></code></span></span></span></span>;

    fn <a href="#method.init" class="fnname">init</a>(&amp;self, _feed_id: FeedId, _data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">]</a>) -&gt; DispatchResult { ... }
<span class="item-spacer"></span>    fn <a href="#method.put" class="fnname">put</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_feed_id: FeedId, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_object: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">]</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="type.FeedMetadata.html" title="type pallet_feeds::feed_processor::FeedMetadata">FeedMetadata</a>&gt;, DispatchError&gt; { ... }
<span class="item-spacer"></span>    fn <a href="#method.delete" class="fnname">delete</a>(&amp;self, _feed_id: FeedId) -&gt; DispatchResult { ... }
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="feed-processor"><a href="#feed-processor">Feed Processor</a></h2>
<p>Feed Processor defines some useful abstractions that are used during the life cycle of the Feed and its objects.
We can provide some custom logic specific to the Feed by implementing a Custom Feed Processor.</p>
<h3 id="feed-metadata"><a href="#feed-metadata">Feed Metadata</a></h3>
<p>Before an object is added to Subspace storage, <code>put</code> on Feed processor to give the impl an opportunity to run the object
through their custom logic and returns some metadata about the object. Metadata is then stored in the runtime overwriting
any metadata of the previous object. The default implementation of Feed processor gives empty metadata about the object.</p>
<h3 id="feed-object-mapping"><a href="#feed-object-mapping">Feed object mapping</a></h3>
<p>Feed indexes the objects in the DSN using offsets within the Block the object is present in. <code>object_mappings</code> is the
only that must be implemented by the Feed processor. Since DSN is a key value store, there are two different ways keys
are derived for given data at the offset within the block</p>
<ul>
<li>Key derived from content. Feeds use Sha256 to derive the key for the data at the offset.</li>
<li>Key provided by the feed processor. Feed processor implementations can instead provide a key for object at the offset.</li>
</ul>
<h3 id="examples"><a href="#examples">Examples</a></h3><h4 id="content-based-addressing-with-default-hasher"><a href="#content-based-addressing-with-default-hasher">Content based addressing with default hasher</a></h4>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">pallet_feeds::feed_processor</span>::{<span class="ident">FeedProcessor</span>, <span class="ident">FeedObjectMapping</span>};
<span class="kw">struct</span> <span class="ident">IPFSLike</span>;
<span class="kw">impl</span><span class="op">&lt;</span><span class="ident">FeedId</span><span class="op">&gt;</span> <span class="ident">FeedProcessor</span><span class="op">&lt;</span><span class="ident">FeedId</span><span class="op">&gt;</span> <span class="kw">for</span> <span class="ident">IPFSLike</span> { <span class="doccomment">///</span>
    <span class="kw">fn</span> <span class="ident">object_mappings</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">_feed_id</span>: <span class="ident">FeedId</span>, <span class="ident">_object</span>: <span class="kw-2">&amp;</span>[<span class="ident">u8</span>]) -&gt; <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">FeedObjectMapping</span><span class="op">&gt;</span> {
        <span class="macro">vec!</span>[<span class="ident">FeedObjectMapping::Content</span> { <span class="ident">offset</span>: <span class="number">0</span> }]
    }
}</code></pre></div>
<p>This implements a Content addressable Feed using default Hasher. The entire object is treated as data and hence the offset is zero.</p>
<h4 id="content-based-addressing-using-custom-hasher"><a href="#content-based-addressing-using-custom-hasher">Content based addressing using custom Hasher</a></h4>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">sp_runtime::traits</span>::{<span class="ident">BlakeTwo256</span>, <span class="ident">Hash</span>};
<span class="kw">use</span> <span class="ident">pallet_feeds::feed_processor</span>::{<span class="ident">FeedProcessor</span>, <span class="ident">FeedObjectMapping</span>};
<span class="kw">struct</span> <span class="ident">IPFSLike</span>;
<span class="kw">impl</span><span class="op">&lt;</span><span class="ident">FeedId</span><span class="op">&gt;</span> <span class="ident">FeedProcessor</span><span class="op">&lt;</span><span class="ident">FeedId</span><span class="op">&gt;</span> <span class="kw">for</span> <span class="ident">IPFSLike</span> { <span class="doccomment">///</span>
    <span class="kw">fn</span> <span class="ident">object_mappings</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">_feed_id</span>: <span class="ident">FeedId</span>, <span class="ident">object</span>: <span class="kw-2">&amp;</span>[<span class="ident">u8</span>]) -&gt; <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">FeedObjectMapping</span><span class="op">&gt;</span> {
        <span class="macro">vec!</span>[<span class="ident">FeedObjectMapping::Custom</span> { <span class="ident">key</span>: <span class="ident">BlakeTwo256::hash</span>(<span class="ident">object</span>).<span class="ident">as_bytes</span>().<span class="ident">to_vec</span>(), <span class="ident">offset</span>: <span class="number">0</span> }]
    }
}</code></pre></div>
<p>This implements a Content addressable Feed using BlakeTwo256 hasher. The entire object is treated as data and hence the offset is zero.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.object_mappings" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/pallet_feeds/feed_processor.rs.html#133">source</a></div><h4 class="code-header">fn <a href="#tymethod.object_mappings" class="fnname">object_mappings</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;_feed_id: FeedId, <br>&nbsp;&nbsp;&nbsp;&nbsp;object: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">]</a><br>) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="enum" href="enum.FeedObjectMapping.html" title="enum pallet_feeds::feed_processor::FeedObjectMapping">FeedObjectMapping</a>&gt;<span class="notable-traits"><span class="notable-traits-tooltip">ⓘ<span class="notable-traits-tooltiptext"><span class="docblock"><span class="notable">Notable traits for <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, A&gt;</span><code class="content"><span class="where fmt-newline">impl&lt;A&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Write.html" title="trait std::io::Write">Write</a> for <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, A&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;A: <a class="trait" href="https://doc.rust-lang.org/nightly/core/alloc/trait.Allocator.html" title="trait core::alloc::Allocator">Allocator</a>,&nbsp;</span></span></code></span></span></span></span></h4></div></summary><div class="docblock"><p>Returns any object mappings inside the given object</p>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="method.init" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/pallet_feeds/feed_processor.rs.html#122-124">source</a></div><h4 class="code-header">fn <a href="#method.init" class="fnname">init</a>(&amp;self, _feed_id: FeedId, _data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">]</a>) -&gt; DispatchResult</h4></div></summary><div class="docblock"><p>Initiates a specific Feed with data transparent to FeedProcessor
Can be called when re-initializing the feed.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.put" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/pallet_feeds/feed_processor.rs.html#128-130">source</a></div><h4 class="code-header">fn <a href="#method.put" class="fnname">put</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;_feed_id: FeedId, <br>&nbsp;&nbsp;&nbsp;&nbsp;_object: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">]</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="type.FeedMetadata.html" title="type pallet_feeds::feed_processor::FeedMetadata">FeedMetadata</a>&gt;, DispatchError&gt;</h4></div></summary><div class="docblock"><p>Puts a feed and returns the Metadata if any.
This is called once per extrinsic that puts a feed into a given feed stream.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.delete" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/pallet_feeds/feed_processor.rs.html#136-138">source</a></div><h4 class="code-header">fn <a href="#method.delete" class="fnname">delete</a>(&amp;self, _feed_id: FeedId) -&gt; DispatchResult</h4></div></summary><div class="docblock"><p>Signals a delete to any underlying feed data.</p>
</div></details></div><h2 id="foreign-impls" class="small-section-header">Implementations on Foreign Types<a href="#foreign-impls" class="anchor"></a></h2><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-FeedProcessor%3CFeedId%3E-for-()" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../../src/pallet_feeds/feed_processor.rs.html#144-149">source</a></span><a href="#impl-FeedProcessor%3CFeedId%3E-for-()" class="anchor"></a><h3 class="code-header in-band">impl&lt;FeedId&gt; <a class="trait" href="trait.FeedProcessor.html" title="trait pallet_feeds::feed_processor::FeedProcessor">FeedProcessor</a>&lt;FeedId&gt; for <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a></h3></section></summary><div class="docblock"><p>Content addressable feed processor impl
Offsets the whole object as content thereby signalling to derive <code>key = hash(object)</code>
Put do not provide any metadata.</p>
</div><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.object_mappings" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="../../src/pallet_feeds/feed_processor.rs.html#146-148">source</a></span><a href="#method.object_mappings" class="anchor"></a><h4 class="code-header">fn <a href="#tymethod.object_mappings" class="fnname">object_mappings</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;_feed_id: FeedId, <br>&nbsp;&nbsp;&nbsp;&nbsp;_object: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">]</a><br>) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="enum" href="enum.FeedObjectMapping.html" title="enum pallet_feeds::feed_processor::FeedObjectMapping">FeedObjectMapping</a>&gt;<span class="notable-traits"><span class="notable-traits-tooltip">ⓘ<span class="notable-traits-tooltiptext"><span class="docblock"><span class="notable">Notable traits for <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, A&gt;</span><code class="content"><span class="where fmt-newline">impl&lt;A&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Write.html" title="trait std::io::Write">Write</a> for <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, A&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;A: <a class="trait" href="https://doc.rust-lang.org/nightly/core/alloc/trait.Allocator.html" title="trait core::alloc::Allocator">Allocator</a>,&nbsp;</span></span></code></span></span></span></span></h4></section></summary><div class="docblock"><p>Maps the entire object as content.</p>
</div></details></div></details><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"></div><script type="text/javascript" src="../../implementors/pallet_feeds/feed_processor/trait.FeedProcessor.js" data-ignore-extern-crates="std" async></script></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="pallet_feeds" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0-nightly (42e1761c7 2022-05-15)" ></div>
</body></html>